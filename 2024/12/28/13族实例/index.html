
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title> | funtim</title>
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>FUNTIM</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;FUNTIM</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1></h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/12/28
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="族实例"><a href="#族实例" class="headerlink" title="族实例"></a><a target="_blank" rel="noopener" href="https://help.autodesk.com/view/RVT/2018/ENU/?guid=Revit_API_Revit_API_Developers_Guide_Revit_Geometric_Elements_Family_Instances_html">族实例</a></h1><p>在本节中，您将了解以下内容：</p>
<ul>
<li>族与族实例的关系</li>
<li>族和族实例特征</li>
<li>如何载入或创建族和族实例特征</li>
<li>族实例与族符号的关系</li>
</ul>
<p> 本节中的页面</p>
<ul>
<li>Identifying Elements 识别元素</li>
<li>FamilyInstances 族实例</li>
<li>Code Samples 代码示例</li>
<li>FamilySymbol 族符号</li>
<li>Family 族</li>
</ul>
<h2 id="识别元素"><a href="#识别元素" class="headerlink" title="识别元素"></a>识别元素</h2><p>在Revit中，判断元素是否为FamilyInstance的最简单方法是使用属性对话框。</p>
<ul>
<li>如果族名称以“系统族”开头，并且禁用了“载入”按钮，则该族属于“系统族”。</li>
</ul>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-96BC987E-5C38-45EF-9621-2D6EF89989B1-low.png"></p>
<p>图41：系统族</p>
<ul>
<li>属于构件族的常规FamilyInstance不以System Family开头。</li>
<li>例如，在下图中，桌子家具的族名为Desk。此外，还启用了“加载”按钮。</li>
</ul>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-67F1CF63-64EF-40E4-BF92-284873CDDB31-low.png"></p>
<p>图42：组件族</p>
<p>有一些例外，例如：体量和内建成员。“族”和“类型”字段为空。</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-A2B06CEE-7E4A-494B-8DE8-7131068F182B-low.png"></p>
<p>图43：体量或内建构件示例</p>
<p>Revit Platform API中的族由三个对象表示：</p>
<ul>
<li>Family </li>
<li>FamilySymbol</li>
<li>FamilyInstance</li>
</ul>
<p>每件对象在族结构中都起着重要的作用。</p>
<p>“族”对象表示整个族，例如单平面门。例如，“单面齐平门族”对应于“单面齐平.rfa”文件。Family对象包含多个FamilySymbols，用于获取所有族符号，以便于将实例从一个符号切换到另一个符号。</p>
<p>FamilySymbol对象表示与Revit UI中的“类型”（例如34”×80”）相对应的一组特定族设置。</p>
<p>FamilyInstance对象表示Revit项目中的实际Type（FamilySymbol）实例。例如，在下图中，FamilyInstance是项目中的一扇门。</p>
<ul>
<li>每个FamilyInstance都有一个FamilySymbol。门是一个34”×80”的实例。</li>
<li>每个FamilySymbol都属于一个Family。34”×80”符号属于单齐平系列。</li>
<li>每个族都包含一个或多个族符号。单齐平系列包含34”×80”符号、34”×84”符号、36”×84”等。</li>
</ul>
<p>注意：虽然大多数组件元素都是通过API类FamilySymbol和FamilyInstance公开的，但也有一些是用特定的API类包装的。例如，AnnotationSymbolType包装FamilySymbol，AnnotationSymbol包装FamilyInstance。</p>
<h2 id="族实例-1"><a href="#族实例-1" class="headerlink" title="族实例"></a>族实例</h2><p>FamilyInstance对象包括梁、支撑、柱、家具、体量等。FamilyInstance对象提供了更详细的属性，以便可以更改项目中的族实例类型和外观。</p>
<h3 id="位置相关属性"><a href="#位置相关属性" class="headerlink" title="位置相关属性"></a>位置相关属性</h3><p>与位置相关的属性显示FamilyInstance对象的物理和几何特征，如方向、旋转和位置。</p>
<h4 id="Orientation-朝向"><a href="#Orientation-朝向" class="headerlink" title="Orientation 朝向"></a>Orientation 朝向</h4><p>对于某些FamilyInstance对象，可以更改面方向或手方向。例如，门可以面向房间或墙壁的外部或内部，并且可以将把手放置在左侧或右侧。下表比较了门、窗和桌子族实例。</p>
<p>表29：比较族实例</p>
<table>
<thead>
<tr>
<th><strong>Boolean Property 布尔属性</strong></th>
<th><strong>Door 门</strong></th>
<th>**Window (Fixed: 36”w × 72”h) **</th>
<th><strong>Desk 书桌</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CanFlipFacing</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr>
<td>CanFlipHand</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
</tbody></table>
<p>如果CanFlipFacing或CanFlipHand为true，则可以分别调用flipFacing（）或flipHand（）方法。这些方法可以分别改变面向方向或手方向。否则，这些方法不执行任何操作并返回False。修改方向时，请记住某些类型的窗可以同时修改手方向和面方向，例如带Trim的3x3平开窗族。门有四种不同的朝向和手方向组合。请参见下图中的组合，下表中列出了相应的布尔值。 </p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-AC8B1DB7-860B-46D3-A0BD-DBF120980580-low.png"></p>
<p>图44：具有不同面方向和手方向的门</p>
<p>表30：相同类型的不同饰面</p>
<table>
<thead>
<tr>
<th><strong>Boolean Property 布尔属性</strong></th>
<th>**Door 1 **</th>
<th>**Door 2 **</th>
<th>**Door 3 **</th>
<th>**Door 4 **</th>
</tr>
</thead>
<tbody><tr>
<td>FacingFlipped</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>HandFlipped</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
</tbody></table>
<h4 id="Orientation-Work-Plane-方位-工作平面"><a href="#Orientation-Work-Plane-方位-工作平面" class="headerlink" title="Orientation - Work Plane 方位-工作平面"></a>Orientation - Work Plane 方位-工作平面</h4><p>也可以更改FamilyInstance的工作平面方向。如果CanFlipWorkPlane为true，则可以设置IsWorkPlaneFlipped属性。尝试为不允许翻转工作平面的FamilyInstance设置此属性将导致异常。</p>
<h4 id="Rotation-Mirrored-旋转-镜像"><a href="#Rotation-Mirrored-旋转-镜像" class="headerlink" title="Rotation - Mirrored 旋转-镜像"></a>Rotation - Mirrored 旋转-镜像</h4><p>镜像属性指示FamilyInstance对象是否已镜像。</p>
<p>表31：门镜像属性</p>
<table>
<thead>
<tr>
<th><strong>Boolean Property 布尔属性</strong></th>
<th>**Door 1 **</th>
<th>**Door 2 **</th>
<th>**Door 3 **</th>
<th>**Door 4 **</th>
</tr>
</thead>
<tbody><tr>
<td>Mirrored</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
</tbody></table>
<p>在前面的门示例中，Door 1和Door 2的Mirror属性为False，而Door 3和Door 4的Mirror属性均为True。这是因为在Revit项目中创建门时，默认结果为“门1”或“门2”。要创建类似“门3”或“门4”的门，必须分别翻转“门1”和“门2”的方向。翻转操作类似于镜像变换，这就是为什么“门3”和“门4”镜像属性为True。 有关在Revit中使用Mirror（）方法的详细信息，请参阅“编辑图元”一章。 #### Rotation - CanRotate和rotate（） 族实例布尔CanRotate属性用于测试族实例是否可以旋转180度。这取决于实例所属的族。例如，在下面的图片中，Window 1（Casement 3×3 with Trim：36”×72”）和Door 1（Double-Glass 2：72”×82”）的CanRotate属性为true，而Window 2（Fixed：36“w × 72“h）的CanRotate属性为false。</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-8E93FD79-81F8-4B3D-B09F-9C9A4A1A556C-low.png"></p>
<p><strong>图45：旋转后的变化</strong> </p>
<p>如果CanRotate为true，则可以调用族实例rotate（）方法，该方法将族实例翻转180度。否则，该方法不执行任何操作并返回False。上图还显示了执行rotate（）方法后的Window 1和Door 1状态。 回想一下本文档前面的旋转图元部分，可以使用ElementTransformUtils.RotateElement（）和ElementTransformUtils.RotateElements（）将族实例（和其他图元）旋转用户指定的角度。</p>
<p><strong>位置</strong> Location属性确定实例在项目中的物理位置。实例可以具有点位置或线位置。 以下特征适用于位置： </p>
<p><em>点位置是LocationPoint类对象-基础、门或桌子都有点位置</em> </p>
<p>线位置是LocationCurve类对象-梁具有线位置。 * 它们都是Location类的子类。 有关位置的详细信息，请参阅编辑元素。</p>
<p>Host和HostFace Host和HostFace都是FamilyInstance属性。 </p>
<p><strong>Host</strong> FamilyInstance对象有一个返回其宿主元素的Host属性。 某些FamilyInstance对象没有宿主元素，如Tables和其他家具，因此Host属性不返回任何内容，因为没有创建主体元素。但是，其他对象（如门和窗）必须具有宿主图元。在这种情况下，Host属性返回窗或门所在的墙元素。请参见下图。</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-837ECA51-19DE-4B19-A304-A5C26F24EBD0-low.png"></p>
<p>图46：以墙为主体的门和窗 </p>
<p><strong>HostFace</strong> HostFace属性获取对族实例的宿主面的参照，或者如果实例放置在工作平面上，则获取对工作平面下面的几何图形面的参照。如果工作平面未参照其他几何图形，或者实例未以面或工作平面为宿主，则此属性将返回空参照。</p>
<p> <strong>子组件和超级组件</strong> FamilyInstance. GetSubmenentIds（）方法返回加载到该族中的族实例的ElementIds。将“Table-Dining Round w Chairs.rfa”的实例放置在项目中时，GetSubmenuentIds（）方法将返回椅子集的ElementIds。 SuperComponent属性返回族实例的父构件。在“Table-Dining Round w Chairs. rfa”中，每个嵌套椅子的族实例超级组件都是“Table-Dining Round w Chairs. rfa”的实例。</p>
<p>代码区域12-1：从FamilyInstance获取子组件和超级组件</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetSubAndSuperComponents</span>(<span class="params">FamilyInstance familyInstance</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    ICollection subElemSet = familyInstance.GetSubComponentIds();</span><br><span class="line">    <span class="keyword">if</span> (subElemSet != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> subElems = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (Autodesk.Revit.DB.ElementId ee <span class="keyword">in</span> subElemSet)</span><br><span class="line">        &#123;</span><br><span class="line">            FamilyInstance f = familyInstance.Document.GetElement(ee) <span class="keyword">as</span> FamilyInstance;</span><br><span class="line">            subElems = subElems + f.Name + <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        TaskDialog.Show(<span class="string">&quot;Revit&quot;</span>,<span class="string">&quot;Subcomponent count = &quot;</span> + subElemSet.Count + <span class="string">&quot;\n&quot;</span> + subElems);</span><br><span class="line">    &#125;</span><br><span class="line">    FamilyInstance super = familyInstance.SuperComponent <span class="keyword">as</span> FamilyInstance;</span><br><span class="line">    <span class="keyword">if</span> (super != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        TaskDialog.Show(<span class="string">&quot;Revit&quot;</span>,<span class="string">&quot;SUPER component: &quot;</span> + super.Name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="几何"><a href="#几何" class="headerlink" title="几何"></a>几何</h3><p>有时，FamilyInstance对象的几何图形会通过连接、剪切、顶盖、延伸或其他在Revit中进行的后期处理进行修改。FamilyInstance.HasModifiedGeometry（）方法标识此FamilyInstance的几何图形是否已从自动生成的默认值修改。GetOriginalGeometry（）方法将返回实例的原始几何体，该几何体在可能发生任何修改之前。若要获取实例的当前几何体，请使用从Element类继承的Geometry属性。</p>
<h3 id="空间元素计算点"><a href="#空间元素计算点" class="headerlink" title="空间元素计算点"></a>空间元素计算点</h3><p>FamilyInstance具有多个成员，用于直接从族实例中阅读有关空间计算点的信息。HasSpatialElementCalculationPoint属性标识此实例是否有一个SpatialElementCalculationPoint用作Revit的搜索点，以标识实例是否位于房间或空间内。如果为true，GetSpatialElementCalculationPoint（）方法将返回此实例的计算点的位置作为XYZ点。</p>
<p>HasSpatialElementFromToCalculationPoints属性标识此实例是否具有一对SpatialElementCalculationPoints，它们用作Revit的搜索点，以标识实例是否位于最多两个房间或空间之间。对于连接两个房间或空间（如门或窗）的族实例，这些点确定哪个房间或空间被视为“从”，哪个被视为“到”。当此属性为true时，GetSpatialElementFromToCalculationPoints（）方法将此实例的计算点的位置作为XYZ点的列表返回。</p>
<h3 id="其它属性"><a href="#其它属性" class="headerlink" title="其它属性"></a>其它属性</h3><p>本部分中的属性特定于Revit的建筑和结构工程功能。它们在各自的章节中都有详细介绍。</p>
<h4 id="房间信息"><a href="#房间信息" class="headerlink" title="房间信息"></a>房间信息</h4><p>FamilyInstance属性包括Room、FromRoom和ToRoom。有关房间的详细信息，请参阅建筑。</p>
<h4 id="空间信息"><a href="#空间信息" class="headerlink" title="空间信息"></a>空间信息</h4><p>FamilyInstance有一个Space属性，用于标识MEP中保存实例的空间。</p>
<h4 id="结构分析模型"><a href="#结构分析模型" class="headerlink" title="结构分析模型"></a>结构分析模型</h4><p>GetAnalyticalModel（）方法检索族实例结构分析模型。</p>
<p>有关分析模型的详细信息，请参阅结构工程。</p>
<h3 id="创建FamilyInstance对象"><a href="#创建FamilyInstance对象" class="headerlink" title="创建FamilyInstance对象"></a>创建FamilyInstance对象</h3><p>通常，FamilyInstance对象是使用Autodesk.Revit.Creation.Document的12种重载方法之一NewFamilyInstance（）创建的。选择使用哪个重载不仅取决于实例的类别，还取决于放置的其他特征，例如是否应将其作为主体、相对于参照标高放置或直接放置在特定面上。详细信息包含在下面的表32 -使用NewFamilyInstance（）创建实例的选项中。</p>
<p>某些FamilyInstance对象需要创建多个位置。在这些情况下，使用此对象提供的更详细的创建方法更合适（请参见表33 -使用其他方法创建实例的选项）。如果未创建实例，则会引发异常。在调用该方法之前，必须将使用的类型&#x2F;符号加载到项目中。</p>
<p>检查NewFamilyInstance（）的所有重载以确保输入FamilySymbol处于活动状态（FamilySymbol.IsActive）。如果输入FamilySymbol处于非活动状态，则该方法将抛出ArgumentException。文档中未使用的符号可能会被停用，以节省内存和再生时间。当符号处于非活动状态时，其几何图形为空，无法访问。为了访问文档中未激活的符号的几何图形，应首先通过调用FamilySymbol.Activate（）来激活该符号。</p>
<p>表32 -使用NewFamilyInstance（）创建实例的选项</p>
<table>
<thead>
<tr>
<th align="left">Category 类别</th>
<th align="left">NewFamilyInstance() parameters NewFamilyInstance（）参数</th>
<th align="left">Comments注解</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Air Terminals Boundary Conditions Casework Communication Devices Data Devices Electrical Equipment Electrical Fixtures Entourage Fire Alarm Devices Furniture Furniture Systems Generic Models Lighting Devices Lighting Fixtures Mass Mechanical Equipment Nurse Call Devices Parking Planting Plumbing Fixtures Security Devices Site Specialty Equipment Sprinklers Structural Connections Structural Foundations Structural Stiffeners Telephone Devices</td>
<td align="left">XYZ, FamilySymbol, StructuralType</td>
<td align="left">在任意位置创建实例，而不参照标高或宿主元素。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Element, StructuralType</td>
<td align="left">如果要在墙壁、地板或天花板上承载</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, XYZ, Element, StructuralType</td>
<td align="left">如果要以墙、楼板或天花板为主体，并且需要以非默认方向，</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Element, Level, StructuralType</td>
<td align="left">如果要以墙、楼板或天花板为宿主并与参照标高关联，</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Level, StructuralType</td>
<td align="left">如果要将其关联到参考标高</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Face, XYZ, XYZ, FamilySymbol XYZ，</td>
<td align="left">如果它是基于面的并且需要以非默认方向，</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Reference, XYZ, XYZ, FamilySymbol</td>
<td align="left">如果它是基于面的，并且需要以非默认方向，则接受对面的引用，而不是对Face</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Face, Line, FamilySymbol</td>
<td align="left">如果它是基于面和线的</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Reference, Line, FamilySymbol</td>
<td align="left">如果它是基于面和线的，但接受对面的引用，而不是面</td>
</tr>
<tr>
<td align="left">Columns Structural Columns</td>
<td align="left">XYZ, FamilySymbol, Level, StructuralType</td>
<td align="left">创建柱，使其底部位于参照标高上。柱将延伸到模型中的下一个可用标高，或者如果参照标高之上没有合适的标高，则将延伸默认柱高。</td>
</tr>
<tr>
<td align="left">Doors Windows</td>
<td align="left">XYZ, FamilySymbol, Element, StructuralType</td>
<td align="left">门和窗必须以墙为宿主。如果可以使用默认方向放置它们，请使用此方法。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, XYZ, Element, StructuralType</td>
<td align="left">如果创建的实例需要以非默认方向</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Element, Level, StructuralType</td>
<td align="left">如果实例需要关联到参照标高</td>
</tr>
<tr>
<td align="left">Structural Framing (Beams, Braces)</td>
<td align="left">Curve, FamilySymbol, Level, StructuralType</td>
<td align="left">根据其曲线创建基于标高的支撑或梁。这是创建梁和支撑的推荐方法</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, StructuralType</td>
<td align="left">在任意位置创建实例</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Element, Level, StructuralType</td>
<td align="left">如果它位于图元（地板等）上，并与参考标高相关联</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Level, StructuralType</td>
<td align="left">如果它与参考标高相关联，</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">XYZ, FamilySymbol, Element, StructuralType</td>
<td align="left">如果它位于图元（地板等）上</td>
</tr>
<tr>
<td align="left">Detail Component</td>
<td align="left">Line, FamilySymbol, View</td>
<td align="left">仅限于基于二维族线的详图符号</td>
</tr>
<tr>
<td align="left">Generic Annotations</td>
<td align="left">XYZ, FamilySymbol, View</td>
<td align="left">仅显示为二维族符号</td>
</tr>
</tbody></table>
<p>结构实例在创建后长度为零。通过使用LocationCurve.Curve属性设置其曲线（FamilyInstance.Location为LocationCurve）来扩展它。</p>
<p>通过使用Document.NewFamilyList（）一次创建多个族实例，可以简化代码并提高性能。此方法有一个参数，该参数是描述要创建的族实例的FamilyInstanceCreationData对象的列表。</p>
<p>代码区域12-2：批量创建族实例</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ICollection <span class="title">BatchCreateColumns</span>(<span class="params">Autodesk.Revit.DB.Document document, Level level</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        List fiCreationDatas = <span class="keyword">new</span> List();</span><br><span class="line"></span><br><span class="line">        ICollection elementSet = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Try to get a FamilySymbol</span></span><br><span class="line">        FamilySymbol familySymbol = <span class="literal">null</span>;</span><br><span class="line">        FilteredElementCollector collector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">        ICollection collection = collector.OfClass(<span class="keyword">typeof</span>(FamilySymbol)).ToElements();</span><br><span class="line">        <span class="keyword">foreach</span> (Element e <span class="keyword">in</span> collection)</span><br><span class="line">        &#123;</span><br><span class="line">                familySymbol = e <span class="keyword">as</span> FamilySymbol;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> != familySymbol.Category)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="string">&quot;Structural Columns&quot;</span> == familySymbol.Category.Name)</span><br><span class="line">                        &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != familySymbol)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">//Create 10 FamilyInstanceCreationData items for batch creation </span></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="number">11</span>; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                        XYZ location = <span class="keyword">new</span> XYZ(i * <span class="number">10</span>, <span class="number">100</span>, <span class="number">0</span>);</span><br><span class="line">                        FamilyInstanceCreationData fiCreationData = <span class="keyword">new</span> FamilyInstanceCreationData(location, familySymbol, level, </span><br><span class="line">                                        StructuralType.Column);</span><br><span class="line">                        <span class="keyword">if</span> (<span class="literal">null</span> != fiCreationData)</span><br><span class="line">                        &#123;</span><br><span class="line">                                fiCreationDatas.Add(fiCreationData);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (fiCreationDatas.Count &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                        <span class="comment">// Create Columns</span></span><br><span class="line">            elementSet = document.Create.NewFamilyInstances2(fiCreationDatas);</span><br><span class="line">        &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Batch creation failed.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;No column types found.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> elementSet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>某些族类型的实例最好通过Autodesk.Revit.Creation.Document.NewFamilyInstance（）以外的方法创建。这些列于下表。</p>
<p>表33 -使用其他方法创建实例的选项</p>
<table>
<thead>
<tr>
<th><strong>Category 类别</strong></th>
<th><strong>Creation method 创建方法</strong></th>
<th><strong>Comments</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Air Terminal Tags Area Load Tags Area Tags Casework Tags Ceiling Tags Communication Device Tags Curtain Panel Tags Data Device Tags Detail Item Tags Door Tags Duct Accessory Tags Duct Fitting Tags Duct Tags Electrical Equipment Tags Electrical Fixture Tags Fire Alarm Device Tags Flex Duct Tags Flex Pipe Tags Floor Tags Furniture System Tags Furniture Tags Generic Model Tags Internal Area Load Tags Internal Line Load Tags Internal Point Load Tags Keynote Tags Lighting Device Tags Lighting Fixture Tags Line Load Tags Mass Floor Tags Mass Tags Mechanical Equipment Tags Nurse Call Device Tags Parking Tags Pipe Accessory Tags Pipe Fitting Tags Pipe Tags Planting Tags Plumbing Fixture Tags Point Load Tags Property Line Segment Tags Property Tags Railing Tags Revision Cloud Tags Roof Tags Room Tags Security Device Tags Site Tags Space Tags Specialty Equipment Tags Spinkler Tags Stair Tags Structural Area Reinforcement Tags Structural Beam System Tags Structural Column Tags Structural Connection Tags Structural Foundation Tags Structural Framing Tags Structural Path Reinforcement Tags Structural Rebar Tags Structural Stiffener Tags Structural Truss Tags Telephone Device Tags Wall Tags Window Tags Wire Tag Zone Tags on Tags Structural Foundation Tags Structural Framing Tags Structural Path Reinforcement Tags Structural Rebar Tags Structural Truss Tags Telephone Device Tags Wall Tags Window Tags Wire Tag Zone</td>
<td>IndependentTag.Create(Document, ElementId, Reference, Boolean, TagMode, TagOrientation, XYZ)</td>
<td>TagMode should be TM_ADDBY_CATEGORY and there should be a related tag loaded when try to create a tag，otherwise exception will be thrown（当尝试创建一个标记时，应该有一个相关的标签载入家庭）</td>
</tr>
<tr>
<td>Material Tags</td>
<td>IndependentTag.Create(Document, ElementId, Reference, Boolean, TagMode, TagOrientation, XYZ)</td>
<td>TagMode应为TM_ADDBY_MATERIAL，并且应加载材质标签族，否则将引发异常</td>
</tr>
<tr>
<td>Multi-Category Tags</td>
<td>IndependentTag.Create(Document, ElementId, Reference, Boolean, TagMode, TagOrientation, XYZ)</td>
<td>TagMode应为TM_ADDBY_MULTICATEGORY，并且应加载多类别标记族，否则将抛出异常</td>
</tr>
<tr>
<td>Title Blocks</td>
<td>ViewSheet.Create(Document, ElementId)</td>
<td>标题栏将添加到新创建的图纸中。</td>
</tr>
</tbody></table>
<p>使用Document.LoadFamily（）或Document.LoadFamilySymbol（）方法加载族和族符号。某些族（如梁）具有多个端点，插入方式与插入单个点实例的方式相同。插入线性族实例后，可以使用Element.Location属性更改其端点。有关详细信息，请参阅代码示例。</p>
<h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><p>用于使用Family Data的代码示例。</p>
<p>有关使用Family Object的详细信息，请查看以下代码示例。请注意，在NewFamilyInstance（）方法中，需要StructuralType参数来指定要创建的族实例的类型。以下是一些示例：</p>
<p>表34：NewFamilyInstance（）方法中StructuralType参数的值</p>
<table>
<thead>
<tr>
<th><strong>Type of Family Instance 族实例的类型</strong></th>
<th><strong>Value of StructuralType StructuralType的值</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Doors, tables, etc. 门、桌子等</td>
<td>NonStructural 非结构</td>
</tr>
<tr>
<td>Beams 梁</td>
<td>Beam 梁</td>
</tr>
<tr>
<td>Braces 支撑</td>
<td>Brace 支撑</td>
</tr>
<tr>
<td>Columns 柱</td>
<td>Column 柱</td>
</tr>
<tr>
<td>Footings 基础</td>
<td>Footing 基础</td>
</tr>
</tbody></table>
<h3 id="创建桌"><a href="#创建桌" class="headerlink" title="创建桌"></a>创建桌</h3><p>以下函数演示了如何将表族加载到Revit项目中，以及如何从该族中的所有符号创建实例。</p>
<p>如果指定的族以前已加载，则LoadFamily（）方法返回false。因此，在以下情况下，在调用此函数之前，不加载族Table-Dining Round w Chairs.rfa。在本例中，默认情况下，桌是在标高1创建的。</p>
<p>代码区域12-3：创建桌</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateTables</span>(<span class="params">Autodesk.Revit.DB.Document document</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    String fileName = <span class="string">@&quot;C:\ProgramData\Autodesk\RVT 2014\Libraries\US Imperial\Furniture\Tables\Table-Dining Round w Chairs.rfa&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try to load family</span></span><br><span class="line">    Family family = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (!document.LoadFamily(fileName, <span class="keyword">out</span> family))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Unable to load &quot;</span> + fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loop through table symbols and add a new table for each</span></span><br><span class="line">    ISet familySymbolIds = family.GetFamilySymbolIds();</span><br><span class="line">    <span class="built_in">double</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (ElementId id <span class="keyword">in</span> familySymbolIds)</span><br><span class="line">    &#123;</span><br><span class="line">        FamilySymbol symbol = family.Document.GetElement(id) <span class="keyword">as</span> FamilySymbol;</span><br><span class="line">        symbol.Activate();</span><br><span class="line">        XYZ location = <span class="keyword">new</span> XYZ(x, y, <span class="number">10.0</span>);</span><br><span class="line"></span><br><span class="line">        FamilyInstance instance = document.Create.NewFamilyInstance(location, symbol, StructuralType.NonStructural);</span><br><span class="line">        x += <span class="number">10.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载桌族并放置每个FamilySymbol的一个实例的结果：</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-5FE17FC0-A248-47AE-A08A-1BBA3156193B-low.png"></p>
<p>图47：在Revit项目中加载族并创建表格 </p>
<h3 id="创建Beam"><a href="#创建Beam" class="headerlink" title="创建Beam"></a>创建Beam</h3><p> 在此示例中，加载的是族符号而不是族，因为加载单个FamilySymbol比加载包含许多FamilySymbol的族要快。</p>
<p>代码区域12-4：创建梁</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FamilyInstance <span class="title">CreateBeam</span>(<span class="params">Autodesk.Revit.DB.Document document, View view</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the given view&#x27;s level for beam creation</span></span><br><span class="line">    Level level = document.GetElement(view.LevelId) <span class="keyword">as</span> Level;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get a family symbol</span></span><br><span class="line">    FilteredElementCollector collector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">    collector.OfClass(<span class="keyword">typeof</span>(FamilySymbol)).OfCategory(BuiltInCategory.OST_StructuralFraming);</span><br><span class="line"></span><br><span class="line">    FamilySymbol gotSymbol = collector.FirstElement() <span class="keyword">as</span> FamilySymbol;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create new beam 10&#x27; long starting at origin</span></span><br><span class="line">    XYZ startPoint = <span class="keyword">new</span> XYZ(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    XYZ endPoint = <span class="keyword">new</span> Autodesk.Revit.DB.XYZ(<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    Autodesk.Revit.DB.Curve beamLine = Line.CreateBound(startPoint, endPoint);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create a new beam</span></span><br><span class="line">    FamilyInstance instance = document.Create.NewFamilyInstance(beamLine, gotSymbol,</span><br><span class="line">                                                                level, StructuralType.Beam);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建门"><a href="#创建门" class="headerlink" title="创建门"></a>创建门</h3><p>创建一个长约180’的长墙，并在运行此示例之前选择它。宿主对象必须支持插入实例;否则NewFamilyInstance（）方法将失败。如果没有为必须在宿主中创建的实例提供宿主元素，或者无法将实例插入到指定的宿主元素中，则方法NewFamilyInstance（）不执行任何操作。</p>
<p>代码区域12-5：创建门</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateDoorsInWall</span>(<span class="params">Autodesk.Revit.DB.Document document, Wall wall</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// get wall&#x27;s level for door creation</span></span><br><span class="line">    Level level = document.GetElement(wall.LevelId) <span class="keyword">as</span> Level;</span><br><span class="line"></span><br><span class="line">    FilteredElementCollector collector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">    ICollection collection = collector.OfClass(<span class="keyword">typeof</span>(FamilySymbol))</span><br><span class="line">                                                .OfCategory(BuiltInCategory.OST_Doors)</span><br><span class="line">                                                .ToElements();</span><br><span class="line">    IEnumerator symbolItor = collection.GetEnumerator();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (symbolItor.MoveNext())</span><br><span class="line">    &#123;</span><br><span class="line">        FamilySymbol symbol = symbolItor.Current <span class="keyword">as</span> FamilySymbol;</span><br><span class="line">        symbol.Activate();</span><br><span class="line">        XYZ location = <span class="keyword">new</span> XYZ(x, y, z);</span><br><span class="line">        FamilyInstance instance = document.Create.NewFamilyInstance(location, symbol, wall, level, StructuralType.NonStructural);</span><br><span class="line">        x += <span class="number">10</span>;</span><br><span class="line">        y += <span class="number">10</span>;</span><br><span class="line">        z += <span class="number">1.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下图显示了在Revit中执行上述代码的结果。请注意，如果指定的位置不在指定的标高上，NewFamilyInstance（）方法将使用位置标高而不是标高。</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-3175405A-CD58-4A39-8DC8-696E76652DBB-low.png"></p>
<p>图48：将门插入墙壁</p>
<h3 id="使用参考方向创建族实例"><a href="#使用参考方向创建族实例" class="headerlink" title="使用参考方向创建族实例"></a>使用参考方向创建族实例</h3><p>使用参照方向可在特定方向上插入项目。</p>
<p>代码区域12-6：使用参考方向创建族实例</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Get a floor to place the beds</span></span><br><span class="line">FilteredElementCollector collector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">Floor floor = collector.OfClass(<span class="keyword">typeof</span>(Floor)).FirstElement() <span class="keyword">as</span> Floor;</span><br><span class="line"><span class="keyword">if</span> (floor != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Find a Bed-Box family</span></span><br><span class="line">    Family family = <span class="literal">null</span>;</span><br><span class="line">    FilteredElementCollector famCollector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">    famCollector.OfClass(<span class="keyword">typeof</span>(Family));</span><br><span class="line">    ICollection collection = famCollector.ToElements();</span><br><span class="line">    <span class="keyword">foreach</span> (Element element <span class="keyword">in</span> collection)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (element.Name.CompareTo(<span class="string">&quot;双人床 - 箱式&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            family = element <span class="keyword">as</span> Family;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (family != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Enumerate the beds in the Bed-Box family</span></span><br><span class="line">        FilteredElementCollector fsCollector = <span class="keyword">new</span> FilteredElementCollector(document);</span><br><span class="line">        ICollection fsCollection = fsCollector.WherePasses(<span class="keyword">new</span> FamilySymbolFilter(family.Id)).ToElements();</span><br><span class="line">        IEnumerator symbolItor = fsCollection.GetEnumerator();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (symbolItor.MoveNext())</span><br><span class="line">        &#123;</span><br><span class="line">            FamilySymbol symbol = symbolItor.Current <span class="keyword">as</span> FamilySymbol;</span><br><span class="line">            symbol.Activate();</span><br><span class="line">            XYZ location = <span class="keyword">new</span> XYZ(x, y, <span class="number">0</span>);</span><br><span class="line">            XYZ direction = <span class="keyword">new</span> XYZ();</span><br><span class="line">            <span class="keyword">switch</span> (i % <span class="number">3</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    direction = <span class="keyword">new</span> XYZ(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    direction = <span class="keyword">new</span> XYZ(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    direction = <span class="keyword">new</span> XYZ(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            FamilyInstance instance = document.Create.NewFamilyInstance(location, symbol, direction, floor, StructuralType.NonStructural);</span><br><span class="line">            x += <span class="number">10</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上一个代码的结果显示在下图中：</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/GUID-86B0A1C3-988D-4C4B-BA8E-3C8C9BDEAAE0-low.png"></p>
<p>图49：使用不同的参照方向创建族实例</p>
<h2 id="族符号"><a href="#族符号" class="headerlink" title="族符号"></a>族符号</h2><p>FamilySymbol类表示族中的单个类型。</p>
<p>每个族可以包含一个或多个族符号。每个FamilyInstance都有一个关联的FamilySymbol，可以从其Symbol属性访问。</p>
<h3 id="热属性"><a href="#热属性" class="headerlink" title="热属性"></a>热属性</h3><p>某些类型的族（门、窗和幕墙嵌板）包含下面窗的“类型属性”窗口中所示的热属性。</p>
<p><img src="https://help.autodesk.com/cloudhelp/2018/ENU/Revit-API/images/FamilyThermalProperties2-76173.jpg"></p>
<p>FamilySymbol的热属性由FamilyThermalProperties类表示，并使用FamilySymbol.GetThermalProperties（）方法检索。可以使用SetThermalProperties（）设置FamilySymbol的FamilyThermalProperties。FamilyThermalProperties类本身的属性是只读的。</p>
<p>计算值的单位如下表所示。</p>
<table>
<thead>
<tr>
<th><strong>Property 属性</strong></th>
<th><strong>Unit 单位</strong></th>
</tr>
</thead>
<tbody><tr>
<td>HeatTransferCoefficient 传热系数</td>
<td>watts per meter-squared kelvin (W&#x2F;(m^2<em>K)</em></td>
</tr>
<tr>
<td>ThermalResistance 热阻</td>
<td>meter-squared kelvin per watt ((m^2K)&#x2F;Watt)</td>
</tr>
</tbody></table>
<p>AnalyticConstructionTypeId属性是构造gbXML类型，并返回与Constructions.xml中constructionType节点的“id”属性对应的值。静态FamilyThermalProperties.Find（）方法将通过Constructions.xml中constructionType节点的“id”属性查找FamilyThermalProperties。</p>
<p> #FamilyType参数 </p>
<p>FamilySymbol的某些参数可以是FamilyType参数。对于这些参数，可以使用Family.GetFamilyTypeParameterValues（）方法获取参数的所有适用值。返回的值是与给定参数的定义所指定的类别相匹配的所有族类型的ElementId。这些元素属于类ElementType或NestedFamilyTypeReference。第二种变体适用于嵌套在族中的类型，因此无法以其他方式访问。NestedFamilyTypeReference元素仅存储有关嵌套FamilyType的基本信息，例如Type的名称、Family的名称和Category。这些元素非常低级，因此被标准元素过滤器绕过，因此获取它们的主要方法是通过Family.GetFamilyTypeParameterValues（）方法。 以下示例演示如何获取FamilySymbol的FamilyType参数的所有族类型参数值。然后将参数的值更改为另一个值。此更改将影响使用加载的FamilySymbol的所有FamilySymbol。</p>
<p>代码区域：获取嵌套的FamilyTypes</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetNestedFamilyTypes</span>(<span class="params">FamilyInstance instance</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// find one FamilyType parameter and all values applicable to it</span></span><br><span class="line"></span><br><span class="line">    Parameter aTypeParam = <span class="literal">null</span>;</span><br><span class="line">    ISet values = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    Family family = instance.Symbol.Family;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (Parameter param <span class="keyword">in</span> instance.Symbol.Parameters)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (param.Definition.ParameterType == ParameterType.FamilyType)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            aTypeParam = param;</span><br><span class="line"></span><br><span class="line">            values = family.GetFamilyTypeParameterValues(param.Id);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (aTypeParam == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        TaskDialog.Show(<span class="string">&quot;Warning&quot;</span>, <span class="string">&quot;The selected family has no FamilyType parameter defined.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (values == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        TaskDialog.Show(<span class="string">&quot;Error&quot;</span>, <span class="string">&quot;A FamilyType parameter does not have any applicable values!?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ElementId newValue = values.Last();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (newValue != aTypeParam.AsElementId())</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (Transaction trans = <span class="keyword">new</span> Transaction(instance.Document, <span class="string">&quot;Setting parameter value&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                trans.Start();</span><br><span class="line">                aTypeParam.Set(newValue);</span><br><span class="line">                trans.Commit();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="族"><a href="#族" class="headerlink" title="族"></a>族</h2><p>“族”类表示整个Revit族。它包含FamilySymbols使用的FamilySymbols。</p>
<h3 id="载入族"><a href="#载入族" class="headerlink" title="载入族"></a>载入族</h3><p>Document类包含LoadFamily（）和LoadFamilySymbol（）方法。</p>
<ul>
<li>LoadFamily（）将整个族及其所有类型或符号加载到项目中。</li>
<li>LoadFamilySymbol（）仅将指定的族符号从族文件载入到项目中。</li>
</ul>
<p><strong>注意：</strong>要提高应用程序的性能并减少内存使用，请尽可能加载特定的FamilySymbol，而不是整个Family对象。</p>
<ul>
<li>使用Options.Application对象GetLibraryPaths（）方法检索族文件路径。</li>
<li>Options.Application对象是使用Application对象的Options属性检索的。</li>
<li>在LoadFamilySymbol（）中，输入参数Name与FamilySymbol对象Name属性返回的字符串值相同。</li>
</ul>
<p>有关详细信息，请参阅代码示例。</p>
<p>类别</p>
<p>FamilyCategory属性指示族的类别，例如柱、家具、结构框架或窗。</p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 funtim
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;John Doe
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
